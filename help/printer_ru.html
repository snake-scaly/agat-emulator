<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<title>Ячейка параллельного интерфейса принтера</title>
</head>

<body>
<h2>Ячейка параллельного интерфейса принтера</h2>
<p>Эмулятор включает в свой состав поддержку двух типов интерфейса принтера: ячейки принтера Centronics для компьютера Apple ][ и ячейки принтера для Агат-9. Оба модуля содержат встроенную поддержку эмуляции принтера Epson FX-85 для расширенной обработки выводимой информации. </p>
<p>Эти ячейки незначительно отличаются в составе настроек (т.к. ячейка для Агат-9 содержит расширенное ПЗУ объёмом 2Кбайта):</p>
<p align="center"><img src="ru/prn9conf.png" alt="Ячейка принтера Агат-9" width="446" height="272" /><img src="ru/prnaconf.png" alt="Ячейка принтера Apple ][" width="455" height="233" /></p>
<p>Основная настройка модуля принтера заключается в указании режима вывода данных. Поддерживаются следующие режимы:</p>
<ol>
  <li>&quot;Сырой&quot; вывод в бинарный файл;</li>
  <li>Вывод текста в кодировке Windows-1251 в текстовый файл;</li>
  <li>Вывод текста и графики в многостраничный графический файл формата TIFF;</li>
  <li>Вывод текста и графики на принтер Windows (в т.ч. для сохранения в формате PDF).</li>
  <li>Вывод напрямую в параллельный порт для печати на подключённом к нему принтере, совместимом с эмулируемой системой (например Агат или Эппл).</li>
</ol>
<p>Активизация модуля производится автоматически в поддерживающих его программах (например, <strong>Агат-Автор</strong>), либо вручную командой <strong>PR#n</strong>, где <strong>n</strong> - номер слота.</p>
<p>При запуске печати открывается окно выбора файла (тип файла выбирается в зависимости от настроек модуля):</p>
<p align="center"><img src="ru/selprint.png" alt="Выбор файла печати" width="748" height="514" /></p>
<p>По умолчанию файлы печати размещаются в подкаталоге <strong>print</strong> каталога эмулятора.</p>
<p>Если в окне выбора печати нажать &quot;<em>Отмена</em>&quot;, вывод данных будет временно отключен, до завершения текущего сеанса печати. </p>
<p>При печати в файл TIFF и на принтер Windows эмулятор выводит дополнительное окно, которое отображает информацию о прогрессе печати: номере текущей страницы, количестве байт, отправленных на принтер в пределах текущей страницы, и общем количестве отправленных на принтер данных. Кроме того, отображаются две кнопки: "Вставить новую страницу" и "Закончить печать."</p>
<p align="center"><img src="ru/printprogress.png" alt="Диалог печати в TIFF и на принтер Windows" width="326" height="205"/> <img src="ru/printprogress2.png" alt="Диалог печати в текстовый файл и в файл без преобразования" width="326" height="134"/></p>
<p>Кнопка "Вставить новую страницу" необходима потому, что программы печати для Агата не рассчитаны на автоматическую подачу бумаги и не посылают никаких специальных команд на принтер для перевода страницы. Они рассчитывают, что пользователь сам увидит, что страница отпечатана, и вставит новый лист вручную. "Вставить новую страницу" позволяет эмулировать ручную подачу бумаги. Судить о том, закончилась ли печать текущей страницы, можно по поведению эмулируемой программы. Например, ТОР после печати каждой страницы отображает диалог "Вставьте следующую страницу," а когда печать полностью завершена, появляется возможность перемещать курсор по меню печати. Кроме того, во время передачи данных на принтер мигает иконка в окне информации, а счетчики переданных данных увеличиваются.</p>
<p>Кнопка "Закончить печать" нужна для того, чтобы закончить печать последней страницы, освободить системные ресурсы и спрятать окно прогресса. Кроме того, при печати в TIFF "Закончить печать" завершает формирование многостраничного TIFF-документа.</p>
<p>При печати в текстовый файл и в файл без обработки выводится упрощённое окно прогресса, которое содержит только общее количество отправленных на принтер данных и кнопку "Закончить печать." В этих форматах ручное управление страницами не требуется.</p>
<p>Наконец, при прямой печати на параллельный порт компьютера никаких диалоговых окон не выводится. Управление портом происходит автоматически, а замена страниц &ndash; так, как если бы к принтеру был подключён реальный Агат.</p>
<p>См. также: <a href="chsystem_ru.html">Изменение конфигурации</a>, <a href="devinfo_ru.html">Описание и настройка устройств</a>, <a href="hardware_ru.html">Поддерживаемое оборудование</a>, <a href="index_ru.html">Главное меню</a></p>
</body>

</html>
